from __future__ import annotations

from typing import Optional
import json
import typer

app = typer.Typer(add_completion=False, no_args_is_help=True)

@app.command()
def info() -> None:
    # Smoke test için basit çıktı
    print("bist_core CLI OK")
    print("symbols: ASELS,BIMAS,THYAO")

@app.command()
import datetime as _dt

def eod(
    date: Optional[str] = typer.Option(
        None,
        "--date", metavar="YYYY-MM-DD",
        metavar="YYYY-MM-DD",
        help="EOD snapshot date (YYYY-MM-DD).",
        show_default=False,
    ),
) -> None:
    if date is None:
        raise typer.BadParameter("--date is required")
    # Testin beklediği şekilde çıktı üretelim
    print(json.dumps({"date": date}))

if __name__ == "__main__":
    app()
